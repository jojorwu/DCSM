# GLM (Global Long-Term Memory) Service - (dcs_memory/services/glm)

Это реализация gRPC сервиса для Глобальной Долгосрочной Памяти (GLM) в рамках проекта Динамической Контекстуализированной Общей Памяти (ДКОП).
Сервис предоставляет API для сохранения, извлечения, обновления и удаления Контекстуализированных Единиц Памяти (КЕП).

Данный сервис использует централизованные определения `.proto` файлов, расположенные в `dcs_memory/common/grpc_protos/`.

## Предварительные требования

*   Python 3.8+
*   Pip

## Настройка и Запуск

1.  **Клонируйте репозиторий** (если вы еще этого не сделали).

2.  **Перейдите в директорию сервиса:**
    ```bash
    cd dcs_memory/services/glm
    ```

3.  **Создайте и активируйте виртуальное окружение (рекомендуется):**
    ```bash
    python3 -m venv venv
    source venv/bin/activate
    ```

4.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

5.  **Сгенерируйте gRPC код:**
    Этот сервис использует `.proto` файлы из центральной директории (`../../common/grpc_protos/`). Скрипт `generate_grpc_code.sh` в текущей директории (`dcs_memory/services/glm/`) отвечает за генерацию Python кода в локальную директорию `generated_grpc/`.
    ```bash
    ./generate_grpc_code.sh
    ```
    *Убедитесь, что скрипт имеет права на выполнение (`chmod +x generate_grpc_code.sh`).*

6.  **Запустите gRPC сервер:**
    Сервер будет запущен на порту `50051` (порт по умолчанию).
    Из директории `dcs_memory/services/glm/`:
    ```bash
    python -m app.main
    ```
    Или, если вы находитесь внутри директории `app/`:
    ```bash
    python main.py
    ```
    *(Обратите внимание, что `main.py` содержит логику для корректной настройки `sys.path` для импортов).*


## API

Сервис реализует gRPC интерфейс, определенный в `glm_service.proto` (находится в `dcs_memory/common/grpc_protos/`).

Основные методы:
*   `StoreKEMs`: Сохранение одной или нескольких КЕП.
*   `RetrieveKEMs`: Извлечение КЕП по критериям.
*   `UpdateKEM`: Обновление существующей КЕП.
*   `DeleteKEM`: Удаление КЕП.

Обратитесь к соответствующим `.proto` файлам для детального описания сообщений запросов и ответов.

## Тестирование

Директория `tests/` предназначена для модульных и интеграционных тестов (пока не реализованы).
