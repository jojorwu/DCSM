# ДКОП (DCSM): Динамическая Контекстуализированная Общая Память

**Интеллектуальная система памяти для современных ИИ-агентов и Больших Языковых Моделей (LLM)**

## Введение

Динамическая Контекстуализированная Общая Память (ДКОП или DCSM - Dynamic Contextualized Shared Memory) — это продвинутая система управления знаниями, разработанная для эффективной работы в сложных, многоагентных ИИ-системах и для расширения возможностей LLM. ДКОП развивает идеи таких подходов, как Cache-Augmented Generation (CAG) и Retrieval-Augmented Generation (RAG), фокусируясь на динамическом, распределенном и глубоко контекстуализированном доступе к информации.

Основная цель системы — предоставлять агентам релевантные знания точно в нужный момент, оптимизируя при этом использование вычислительных ресурсов и способствуя совместному накоплению и использованию знаний в группе агентов.

## Основные Принципы

Система ДКОП базируется на следующих ключевых принципах:

*   **Контекстуализированные Единицы Памяти (КЕП)**: Знания в системе не являются монолитными блоками, а представляются в виде семантически связанных "Контекстуализированных Единиц Памяти" (КЕП). Каждая КЕП — это не просто фрагмент данных, а структурированный объект, содержащий сам контент и богатые метаданные (например, тема, источник, временные метки, права доступа, векторные эмбеддинги). Такой подход обеспечивает гранулированное и интеллектуальное управление знаниями.

*   **Иерархическая Структура Памяти**: Для достижения оптимального баланса между скоростью доступа и объемом хранимой информации, ДКОП использует многоуровневую архитектуру памяти:
    *   **GLM (Глобальная/Долгосрочная Память)**: Основное, персистентное хранилище для всех КЕП в системе. Обеспечивает надежность и долговременное сохранение знаний.
    *   **SWM (Общая Рабочая Память)**: Высокопроизводительный, активный кэширующий слой. SWM хранит "горячие" (часто используемые или недавно запрошенные) КЕП, с которыми непосредственно взаимодействуют агенты.
    *   **ЛПА (Локальная Память Агента)**: Краткосрочный кэш на стороне каждого агента, реализованный в Agent SDK. Хранит наиболее релевантные для конкретного агента КЕП, минимизируя задержки.

*   **Динамическое Управление и Обмен Знаниями**:
    *   SWM динамически управляет своим содержимым, подгружая необходимые КЕП из GLM и вытесняя менее актуальные по LRU-стратегии (Least Recently Used).
    *   Система поддерживает механизм Pub/Sub через SWM, позволяя агентам подписываться на интересующие их типы событий или изменения в КЕП и публиковать новые или обновленные КЕП, делая их доступными для других участников системы.

## Архитектура Системы

ДКОП реализована как набор взаимодействующих микросервисов, общающихся посредством gRPC.

*   **GLM (Global Long-Term Memory Service)**:
    *   **Назначение**: Персистентное хранилище всех КЕП.
    *   **Технологии**: Использует SQLite для хранения метаданных и основного контента КЕП, и Qdrant (векторную базу данных) для хранения эмбеддингов и выполнения семантического поиска.

*   **KPS (Knowledge Processor Service)**:
    *   **Назначение**: Точка входа для новых знаний в систему.
    *   **Функции**: Принимает сырые данные (например, текст), обрабатывает их, генерирует векторные эмбеддинги с помощью моделей `sentence-transformers` и формирует КЕП для последующего сохранения в GLM.

*   **SWM (Shared Working Memory Service)**:
    *   **Назначение**: Активный кэширующий слой и хаб для обмена знаниями между агентами.
    *   **Функции**: Кэширует КЕП, управляет их жизненным циклом в кэше (LRU-вытеснение с индексацией), обеспечивает Pub/Sub механизм для событий памяти, может загружать данные из GLM и сохранять их обратно.

*   **Agent SDK (Python)**:
    *   **Назначение**: Предоставляет удобный Python-интерфейс для агентов для взаимодействия с сервисами ДКОП.
    *   **Функции**: Включает клиент для GLM, реализует ЛПА (Локальную Память Агента) с кэшированием и индексацией, упрощает интеграцию логики агентов с системой памяти.

**Упрощенная схема взаимодействия:**
```
+-------------------+     +---------------------+     +-------------------+
|      Агенты       |<--->|     Agent SDK       |<--->|        SWM        |
| (Пользователи КЕП)|     | (ЛПА, Клиенты S/G)  |     | (Кэш, Шина Памяти)|
+-------------------+     +---------------------+     +-------------------+
                                                        |      ^ (Загрузка/
                                                        |        Сохранение)
                                                        v      |
                                        +---------------------+
                                        |         GLM         |
                                        | (Qdrant, SQLite)  |
                                        +---------------------+
                                                  ^
                                                  | (Сохранение КЕП)
                                                  |
                                        +---------------------+
                                        |         KPS         |
                                        | (Обработка, Эмбед.) |
                                        +---------------------+
```
Более подробное описание архитектуры, форматов данных и взаимодействия компонентов вы найдете в документе [dcs_memory/ARCHITECTURE.md](dcs_memory/ARCHITECTURE.md).

## Ключевые Преимущества

*   **Контекстуализация Знаний**: Благодаря хранению КЕП с богатыми метаданными и векторными эмбеддингами, система позволяет осуществлять глубокий семантический поиск и предоставлять агентам информацию в точном соответствии с их текущим контекстом.
*   **Многоуровневое Кэширование**: Иерархия памяти (GLM, SWM, ЛПА) обеспечивает оптимальный баланс между скоростью доступа к "горячим" данным и возможностью хранения больших объемов информации в долгосрочной памяти.
*   **Гибкость и Масштабируемость**: Микросервисная архитектура и использование gRPC для взаимодействия компонентов позволяют системе быть гибкой в развертывании и масштабировании отдельных ее частей.
*   **Динамичность и Адаптивность**: SWM и ЛПА динамически адаптируют свое содержимое под текущие нужды агентов, используя LRU-стратегии и (в SWM) Pub/Sub механизм для своевременного обновления релевантной информацией.
*   **Эффективный Поиск**: Интеграция с векторной базой данных Qdrant в GLM обеспечивает мощные возможности для семантического поиска и нахождения близких по смыслу КЕП. `IndexedLRUCache` в SWM и ЛПА также ускоряет поиск по метаданным в кэшах.
*   **Поддержка Коллективной Работы**: SWM выступает как общая рабочая область, где агенты могут публиковать новые знания и подписываться на обновления от других агентов, способствуя синергии в многоагентных системах.

## Начало Работы

Для запуска системы ДКОП локально вам потребуется Docker и docker-compose.

1.  Клонируйте репозиторий:
    ```bash
    # Замените <repo_url> на актуальный URL вашего репозитория
    git clone <repo_url>
    cd <имя_директории_репозитория>
    ```
2.  Запустите все сервисы с помощью docker-compose:
    ```bash
    docker-compose up --build
    ```
    Эта команда соберет Docker-образы для всех сервисов (если они еще не собраны) и запустит их.

После успешного запуска будут доступны следующие сервисы:
*   **Qdrant**: векторная БД (порт gRPC 6333, HTTP 6334)
*   **GLM Service**: gRPC на порту 50051
*   **KPS Service**: gRPC на порту 50052
*   **SWM Service**: gRPC на порту 50053

Вы можете начать взаимодействие с системой, используя [Agent SDK (Python)](dcsm_agent_sdk_python/README.md) или любой другой gRPC-клиент. Примеры использования SDK можно найти в `dcsm_agent_sdk_python/example.py`.

## Статус Проекта и Будущие Направления

Система ДКОП находится в стадии активной разработки. Текущая реализация включает все основные описанные компоненты и базовую функциональность.

**Ключевые направления дальнейшего развития:**
*   Полноценная реализация Pub/Sub механизма в SWM с использованием `asyncio` или интеграцией с брокерами сообщений.
*   Разработка более сложных политик кэширования и вытеснения в SWM.
*   Расширение возможностей фильтрации и запросов в SWM.
*   Усиление аспектов безопасности: аутентификация и авторизация.
*   Комплексное интеграционное и нагрузочное тестирование.
*   Улучшение механизмов отказоустойчивости и обработки ошибок.

Мы приглашаем к обсуждению и возможному участию в развитии проекта!

---
*(Опционально: здесь можно добавить разделы "Contributing" и "License", если это применимо к вашему проекту.)*
